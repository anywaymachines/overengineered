import { Players } from "@rbxts/services";
import { DiscordWebhook } from "server/DiscordWebhook";
import { GameDefinitions } from "shared/data/GameDefinitions";

/** If the player is not an admin, bans him and returns true */
export const isNotAdmin_AutoBanned = (player: Player, commandName: string): boolean => {
	if (GameDefinitions.isAdmin(player)) return false;

	$warn(`Player ${player.Name} tried to invoke an admin command ${commandName}`);
	task.spawn(() => {
		DiscordWebhook.sendMessage({
			content: `Player ${player.Name} tried to invoke an admin command ${commandName}`,
		});
	});

	Players.BanAsync({
		UserIds: [player.UserId],
		Duration: -1, // infinite
		DisplayReason: "Exploiting",
		PrivateReason: "Exploiting",
	});
	return true;
};
